name: Jekyll build & deploy

on: push

jobs:
  build_and_deploy:

    runs-on: ubuntu-latest

    steps:
      - name: ðŸ›Ž Check out
        uses: actions/checkout@v3.0.1
      - name: work around permission issue
      # Use GitHub Actions' cache to shorten build times and decrease load on servers
      - name: Cache
        uses: actions/cache@v2
        with:
          path: vendor/bundle
          key: ${{ runner.os }}-gems-${{ hashFiles('**/Gemfile') }}
          restore-keys: |
            ${{ runner.os }}-gems-
      - name: Jekyll Actions
        uses: helaili/jekyll-action@2.3.1
        with:
          token: ${{ secrets.JEKYLL_PAT }}
      - name: Pushes to another repository
        uses: cpina/github-action-push-to-another-repository@main
        env:
          API_TOKEN_GITHUB: ${{ secrets.JEKYLL_PAT }}
        with:
          source-directory: 'site'
          destination-github-username: 'parkmuhyeun'
          destination-repository-name: 'parkmuhyeun.github.io'
          user-email: pjhg410@gmail.com
          target-branch: master
